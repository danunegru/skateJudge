<div class="exam-container" *ngIf="event && exam">
  <h1>{{ exam.name }}</h1>
  
  <div class="details-wrapper">
    <button class="toggle-button" (click)="toggleDetails()" type="button">
      <span>{{ isDetailsExpanded ? 'Details ausblenden' : 'Details anzeigen' }}</span>
      <span class="toggle-icon" [class.rotated]="isDetailsExpanded">▼</span>
    </button>
    
    <div class="details-container" [class.collapsed]="!isDetailsExpanded">
      <div class="event-details">
        <h3>Event Details</h3>
        <p><span><strong>Event:</strong></span> {{ event.name }}</p>
        <p><span><strong>Veranstalter:</strong></span> {{ event.veranstalter }}</p>
        <p><span><strong>Ort:</strong></span> {{ event.place }}</p>
        <p><span><strong>Datum:</strong></span> {{ event.startDate | date:'dd.MM.yyyy' }} - {{ event.endDate | date:'dd.MM.yyyy' }}</p>
        <p><span><strong>Prüflinge:</strong></span> {{ prueflingeForExam.length || 0 }}</p>
      </div>
      
      <div class="header-info">
        <h3>Wertungsrichter:in</h3>
        <div class="info-grid">
          <span><strong>Mindestpunktzahl:</strong></span>
          <span>6,0</span>
          <span><strong>Durchschnittswert:</strong></span>
          <span>1,5</span>
          <span><strong>Keine Note unter:</strong></span>
          <span>1,0</span>
        </div>
      </div>
    </div>
  </div>

  <table class="score-table" *ngIf="prueflingeForExam.length > 0">
    <thead>
      <tr>
        <th rowspan="3" class="element-header">Elemente</th>
        <th [attr.colspan]="prueflingeForExam.length">Athleten</th>
      </tr>
      <tr>
        <th class="number-cell" *ngFor="let pruefling of prueflingeForExam; let i = index">{{ i + 1 }}.</th>
      </tr>
      <tr>
        <td class="athlete-cell" *ngFor="let pruefling of prueflingeForExam">
          <div class="athlete-info">
            <div class="verein-display">{{ pruefling.verein }}</div>
            <div class="name-display">{{ pruefling.vorname }} {{ pruefling.nachname }}</div>
          </div>
        </td>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="element-header">
          <div class="element-content">1. rechts und links vorwärts übersetzen</div>
        </td>
        <td *ngFor="let pruefling of prueflingeForExam; let i = index">
          <input type="number" step="0.1" min="1.0" max="6.0" [attr.data-element]="1" [attr.data-athlete]="i + 1">
        </td>
      </tr>
      <tr>
        <td class="element-header">
          <div class="element-content">2. rechts und links rückwärts übersetzen</div>
        </td>
        <td *ngFor="let pruefling of prueflingeForExam; let i = index">
          <input type="number" step="0.1" min="1.0" max="6.0" [attr.data-element]="2" [attr.data-athlete]="i + 1">
        </td>
      </tr>
      <tr>
        <td class="element-header">
          <div class="element-content">3. Flieger mit Kante</div>
        </td>
        <td *ngFor="let pruefling of prueflingeForExam; let i = index">
          <input type="number" step="0.1" min="1.0" max="6.0" [attr.data-element]="3" [attr.data-athlete]="i + 1">
        </td>
      </tr>
      <tr>
        <td class="element-header">
          <div class="element-content">4. Bremsen durch Drehung auf rückwärts und auf die Stopper</div>
        </td>
        <td *ngFor="let pruefling of prueflingeForExam; let i = index">
          <input type="number" step="0.1" min="1.0" max="6.0" [attr.data-element]="4" [attr.data-athlete]="i + 1">
        </td>
      </tr>
      <tr class="total-row">
        <td class="element-header">Erreichte Gesamtpunktzahl:</td>
        <td *ngFor="let pruefling of prueflingeForExam; let i = index" [attr.id]="'total-' + (i + 1)">0.0</td>
      </tr>
    </tbody>
  </table>

  <!-- Show message when no participants are registered -->
  <div class="no-participants" *ngIf="prueflingeForExam.length === 0">
    <mat-card>
      <mat-card-content>
        <h3>Keine Teilnehmer für {{ exam.name }}</h3>
        <p>Es sind noch keine Prüflinge für diese Prüfung angemeldet.</p>
        <p>Bitte fügen Sie Teilnehmer über die Veranstaltungsdetails hinzu.</p>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Alternative back button with Material Design -->
  <button mat-stroked-button color="primary" (click)="goBackToEventDetails()" class="back-button-material">
    <mat-icon>arrow_back</mat-icon>
    Zurück zur Veranstaltung
  </button>
</div>